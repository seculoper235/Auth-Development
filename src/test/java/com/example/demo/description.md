# TDD(테스트 주도 개발)
**RED -> GREEN -> BLUE**

<br/>

### 개념 요약
*      철저하게 개발/설계 관점에서 개발되는 방식
*      코드를 작성하고 싶어? 그럼 테스트부터 통과해!
*      코드를 짜기 전에 생각해보셨나요?

<br/>

**TDD**는 사실 말이 개발 방법론이지, **습관에 가깝다**고 생각한다\
일반적으로 마구잡이로 진행되는 개발을 좀 더 **깔끔하고 올바르게 사용하기 위한 개발 습관을 들인다**고 생각하면 된다

이런 습관을 들이기 위해서 꼭 지켜야 할 3가지 원칙이 있는데, 그게 무엇인지 알아보자

---
## TDD 3단계 원칙
다음의 단계를 계속 반복하며 개발해나가는 것이 원칙이다

    1. 테스트 목표 세우기
      : "이렇지만 않으면 이상적인 코드다" 싶은 실패 테스트 케이스들을 작성한다

    2. 딴건 필요없다. 오로지 테스트가 성공하기 위해 코드를 작성한다

    3. 성공했다면 중복 제거 등 로직에 영향이 없는 코드 정리를 한다

---
## 일반적인 개발 순서
    1. 일단 코드를 작성하거나 수정한다

    2. 잘 동작하는지 돌려본다(실행)

    3. 컴파일 에러가 난다? -> 아 여기 코드 작성이 잘못됬네...(1번으로)

    4. 실행은 잘 되네. 값을 넣어보자

    5. 다른 Exception이 발생한다 -> 왜 그러지..여긴가?(1번으로)

---
## TDD 순서
    1. 일단 코드를 작성하...기 전에 생각을 하자. 지금 작성해야 할 혹은 수정하거나 리팩토링 할 로직에 대해 정확히 숙지해야한다

    2. 지금 작성할 이 로직이라면 최소한 이렇지는 말아야지..!, 이래야지..!하는 것들을 그대로 테스트로 작성한다(결과값이든 에러든 뭐든 좋다)
      - 어떤 에러가 날지 모른다면, 반환되야 하는 결과값을 넣는다
      - 모두 통과인데 리팩토링을 하고 싶다면? 무작정 수정하지 말고, 어떤 단계로 어느 것부터 수정할지 생각하고, 각 단계나 클래스에서 에러가 날 법한 케이스들을 모두 적는다
      - 즉, 리팩토링에 대해 이미 머릿속에 절차가 모두 끝나 있어야 한다!

    3. 일단 테스트 실행~~

    4. 테스트가 성공했다면 테스트를 잘못 작성했거나, 수정할/작성할 로직에 대해 잘못 알고있는 것이다(1번으로..)

    5. 실패했다면 OK! 이제 목표가 생겼으니, 오로지 해당 테스트들이 성공하기 위한 코드만을 작성한다

    6. 다 됐으니 코드 정리좀 하자. 어디까지나 실행에 해를 끼치지 않는 선에서 정리만 하는 것이다

---
## 메인 원칙
      1. 반드시 테스트를 먼저 작성해야 한다

      2. 오로지 테스트가 성공하기 위한 코드를 작성해야 한다
      (새로 작성하기 위한 로직은 말할것도 없고, 리팩토링 로직은 충분히 생각하고 어떻게 코드를 수정해야 할지 먼저 정해야 할 것이다)

      3. 테스트 성공 후에는 반드시 코드 정리만 수행해야 한다
      (현재 테스트의 성공을 보장하기 위함)

---
## 장점
      1. 테스트를 통과해야 한다는 목표가 있어서 재미가 있다

      2. 로직이 돌아가기 위해 필수로 통과되어야 할 것들을 미리 알 수 있다

      3. 2 원칙에 의해 과하지 않은 필요한 코드만 작성할 수 있다

      4. 당연하게도 이미 작성한 테스트들을 비슷한 케이스에 재활용할 수 있다

      5. 코드의 안정성을 보장한다

---
## 단점
      1. 테스트 코드 작성 방법이 어렵다(문법, 설정 등)

      2. "지금 코드를 작성해보기도 전에 어떻게 작성해야 하는지 상세히 아는 것"은 로직 설계에 대한 충분한 이해와 경험, 노력이 필요하며, 코드 작성 전에 생각 자체가 너무 길어질 수 있다

      3. 테스트의 목표가 없다. 굳이 따지자면 안정성 있는 완벽한 코드가 목표이며, 지극히 주관적이기에 개발자마다 다르다

      4. 개발 단계에서의 코드 안정성에 집착하여 "실제 원하는 동작의 구현"(BDD)과 멀어질 수 있다

      5. 보통 행해지는 단위 테스트는 단순한 테스트 함수에 불과하다. TDD로 개발이 끝난 이후에 맞는지 아닌지 돌려보는 함수에 불과한 것이다

---
## 예시
    장 볼 리스트 적어놓고 장보기

---
# BDD(행위 주도 개발)
**Given -> When -> Then**

**Describe -> Context -> It**

<br/>

### 개념 요약
*      시스템 행위를 기반으로 개발되는 방식
*      테스트를 짜기 어려워? 그럼 시스템 동작을 목표로 삼아!

<br/>

### TDD의 한계
TDD가 코드의 안정성을 보장하긴 하나, 테스트의 목표가 정해져있지 않고 개발자 주관으로 작성하게 된다\
즉 자칫 잘못하면 코드에 집착하여 정작 원하는 시스템 동작은 이뤄지지 않을 수 있다

#### 그렇다면 성공 케이스의 목표를 태초의 목표인 실제 시스템 동작으로 삼으면 어떨까?

누구나 쉽게 케이스의 목표를 세우고 개발할 수 있을 것이다\
이것이 바로 행위 기반의 개발, BDD의 개념이다!

---
## 예시
    Given: 장바구니에 상품을 넣어놓고

    When: 구매하면,

    Then: 구매한 상품 정보가 뜬다

---
# ATDD(인수테스트 주도 개발)
**Feature -> Rule -> Scenario**

<br/>

### 개념 요약
인수 테스트를 기반으로 하는 TDD 이다\
단순 기능 / 행위가 아닌 일반 사용자가 지정한 시나리오대로 개발이 되어야 할 때 진행하는 방법이다\
BDD 보다 세밀하게 상황을 구성할 수 있으며, 이쯤되면 코드보다 상황 설명이 더 복잡하다

사용 도구로는 ***cucumber***가 있다

---
## 예시
    Feature: 다중 사이트 지원
             블로그 소유자만 블로그에 게시할 수 있으며, 관리자는 예외입니다
             관리자는 모든 블로그에 게시할 수 있습니다
    
        Rule: X,
    
            Background: "Greg"라는 글로벌 관리자가 있고
                        "Greg's anti-tax rants"라는 블로그가 있고
                        "Dr. Bill"이라는 고객이 있고
                        "Dr. Bill"이 소유한 "Expensive Therapy"라는 블로그가 있습니다
        
            Example / Scenario: 빌 박사는 자신의 블로그에 게시합니다
        
                Given / When / Then:
                        Given: 내가 빌 박사로 로그인되어 있다고 가정
                        When: "Expensive Therapy"에 게시하려고 하면
                        Then: "당신의 기사가 게시되었습니다."라는 메시지가 표시
        
            Example / Scenario: 빌 박사가 다른 사람의 블로그에 게시하려고 했지만 실패했습니다
        
                Given / When / Then:
                        Given: 내가 빌 박사로 로그인한 경우
                        When: "그레그의 반세금 폭언"에 게시하려고 하면
                        Then: "이봐요! 그건 당신 블로그가 아니에요!"라는 메시지가 나와야 합니다

---
